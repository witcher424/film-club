pkgname=kkkustoms
pkgver=0.1.1
pkgrel=1
pkgdesc="intermediate layer between kkk desktop app and database"
license=('GPL')
arch=('i686' 'pentium4' 'x86_64' 'arm' 'armv7h' 'armv6h' 'aarch64')
makedepends=('go')
options=('strip')

srcs=('main.go' 'handlers.go' 'db.go' 'types.go')

prepare() {
    for src in "${srcs[@]}"; do
        cp "$startdir/$src" "$srcdir"
    done
}

build() {
    go build -o "$pkgname"
}

package() {
    destdir="$pkgdir/usr/bin"
    mkdir "$destdir" -p
    cp "$srcdir/$pkgname" "$destdir"

    configdir="$pkgdir/etc/"
    mkdir "$configdir" -p
    cp "$startdir/default-config.json" "$configdir/${pkgname}.json"

    systemdir="$pkgdir/etc/systemd/system"
    mkdir "$systemdir" -p
    cp "$startdir/kkkustoms.service" "$systemdir"
}
